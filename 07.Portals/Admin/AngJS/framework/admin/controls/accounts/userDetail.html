<div class="container-fluid cv-details-form full-height">
  <div cef-standard-detail-header-widget
    record="userDetailCtrl.record"
    new-kind-key="ui.admin.common.User.New"
    existing-kind-key="ui.admin.common.User">
  </div>
  <div class="row details-body">
    <div class="col-md-12 user-editor">
      <uib-tabset class="tabs-left" vertical="true">
        <uib-tab>
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Details.$invalid}"
            ><i class="far fa-lg fa-info"></i>&nbsp;<span
            data-translate="ui.admin.common.Detail.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.Details">
            <div class="row">
              <div class="col-sm-6">
                <h3 data-translate="ui.admin.common.BasicInformation"></h3>
                <div class="row">
                  <select-form-group
                    class="col-sm-6"
                    key="TypeID"
                    ng-model="userDetailCtrl.record.TypeID"
                    selections="userDetailCtrl.types"
                    label-key="ui.admin.common.Type"
                    placeholder-key="ui.admin.common.Type"
                    ng-disabled="!userDetailCtrl.record.ID"
                    ng-required="userDetailCtrl.record.ID"
                    include-null="true"
                    null-key="ui.admin.common.Type.SelectA">
                  </select-form-group>
                  <select-form-group
                    class="col-sm-6"
                    key="StatusID"
                    ng-model="userDetailCtrl.record.StatusID"
                    selections="userDetailCtrl.statuses"
                    label-key="ui.admin.common.Status"
                    placeholder-key="ui.admin.common.Status"
                    ng-disabled="!userDetailCtrl.record.ID"
                    ng-required="userDetailCtrl.record.ID"
                    include-null="true"
                    null-key="ui.admin.common.Status.SelectA">
                  </select-form-group>
                </div>
                <div class="row">
                  <text-input-form-group
                    class="col-sm-9"
                    key="CustomKey"
                    ng-model="userDetailCtrl.record.CustomKey"
                    label-key="ui.admin.common.CustomKey"
                    placeholder-key="ui.admin.common.Key"
                    max-length="128"
                    ng-required="true">
                  </text-input-form-group>
                  <div class="form-group col-sm-3">
                    <label class="control-label"
                      data-translate="ui.admin.controls.accounts.userDetail.CreatedDate">
                    </label>
                    <div class="input-group">
                      <label class="form-control-static font-weight-normal"
                        ng-bind="userDetailCtrl.record.CreatedDate | date">
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="form-group col-sm-12"
                    ng-class="{'has-error': userDetailCtrl.forms.Details.taAccount.$invalid}">
                    <label class="control-label" for="taAccount"
                      data-translate="ui.admin.common.Account">
                    </label>
                    <div class="input-group">
                      <input type="text" class="form-control typeahead"
                        id="taAccount" name="taAccount"
                        ng-required="false"
                        translate-attr="{ placeholder: 'ui.admin.controls.sales.salesOrderNewWizard.SearchAccounts.Ellipses' }"
                        uib-typeahead="a.ID as (a.Name + (a.CustomKey && a.CustomKey != '' ? ' [' + a.CustomKey + ']' : ''))
                                       for a in userDetailCtrl.grabAccounts(userDetailCtrl.accountToGrab)"
                        typeahead-wait-ms="500" typeahead-min-length="1" typeahead-no-results="userDetailCtrl.noAccountResults"
                        typeahead-loading="userDetailCtrl.loadingAccounts"
                        typeahead-on-select="userDetailCtrl.selectAccountFromTypeAhead($item, $model, $label, $event)"
                        ng-model="userDetailCtrl.accountToGrab" />
                      <div class="input-group-addon">
                        <i class="far fa-refresh" ng-if="userDetailCtrl.loadingAccounts"></i>
                        <i class="far fa-times" ng-if="userDetailCtrl.noAccountResults"></i>
                        <i class="far fa-check" ng-if="userDetailCtrl.accountID"></i>
                        <i class="far fa-question"
                          ng-if="!userDetailCtrl.loadingAccounts
                            && !userDetailCtrl.noAccountResults
                            && !userDetailCtrl.accountID">
                        </i>
                      </div>
                    </div>
                    <div ng-if="userDetailCtrl.noAccountResults"
                      data-translate="ui.admin.controls.sales.salesOrderNewWizard.NoAccountsFound">
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.taAccount.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                  <div class="form-group col-sm-12" ng-if="userDetailCtrl.record.Account">
                    <b data-translate="ui.admin.common.Account"></b>&nbsp;<!--
                    --><a ui-sref="accounts.accounts.detail({ 'ID': userDetailCtrl.record.AccountID })"
                      target="_blank"
                      ><span data-translate="ui.admin.common.Number.Symbol"
                      ></span>{{userDetailCtrl.record.AccountID}}&nbsp;<!--
                    -->[{{userDetailCtrl.record.Account.CustomKey}}]&nbsp;<!--
                    -->{{userDetailCtrl.record.Account.Name}}</a><br />
                    <b data-translate="ui.admin.common.Active"></b> {{('ui.admin.common.' + (userDetailCtrl.record.Account.Active ? "Yes" : "No")) | translate}}
                    <b data-translate="ui.admin.common.OnHold"></b> {{('ui.admin.common.' + (userDetailCtrl.record.Account.IsOnHold ? "Yes" : "No")) | translate}}
                    <b data-translate="ui.admin.common.Status"></b> {{userDetailCtrl.record.Account.StatusDisplayName || userDetailCtrl.record.Account.StatusName}}
                    <b data-translate="ui.admin.common.Type"></b> {{userDetailCtrl.record.Account.TypeDisplayName || userDetailCtrl.record.Account.TypeName}}
                  </div>
                  <!--
                  <div class="form-group col-sm-12" ng-class="{'has-error': userDetailCtrl.forms.Details.ddlAccount.$invalid}">
                    <label class="control-label" data-translate="ui.admin.controls.accounts.userDetail.AssignedAccount"></label>
                    <div class="input-group">
                      <select class="form-control" id="ddlAccount" name="ddlAccount"
                        ng-options="a.ID as ((a.DisplayName || a.Name) + (a.CustomKey  && a.CustomKey != '' ? ' [' + a.CustomKey + ']' : ''))
                                    for a in userDetailCtrl.accounts
                                    | orderBy: ['SortOrder','DisplayName || Name']"
                        ng-model="userDetailCtrl.record.AccountID">
                        <option value="" data-translate="ui.admin.controls.accounts.userDetail.NoAccount"></option>
                      </select>
                      <p ng-if="userDetailCtrl.record.Account && !userDetailCtrl.record.Account.Active">
                        <b data-translate="ui.admin.common.Note"></b>&nbsp;
                        <span data-translate="ui.admin.controls.accounts.userDetail.TheCurrentlyAssignedAccountIsDeactivatedAndWontShowInTheAssigned"></span></p>
                      <div ng-messages="userDetailCtrl.forms.Details.ddlAccount.$error">
                        <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                      </div>
                    </div>
                  </div>
                  -->
                </div>
                <div class="row">
                  <div ng-if="userDetailCtrl.cefConfig.featureSet.multiCurrency.enabled"
                    class="form-group col-sm-6"
                    ng-class="{'has-error': userDetailCtrl.forms.Details.ddlCurrency.$invalid}">
                    <label class="control-label" data-translate="ui.admin.common.Currency"></label>
                    <div class="input-group">
                      <select class="form-control" id="ddlCurrency" name="ddlCurrency"
                        ng-options="c.ID as ((c.DisplayName || c.Name) + (c.CustomKey  && c.CustomKey != '' ? ' [' + c.CustomKey + ']' : ''))
                                    for c in userDetailCtrl.currencies
                                    | orderBy: ['SortOrder','DisplayName || Name']"
                        ng-model="userDetailCtrl.record.CurrencyID">
                        <option value="" data-translate="ui.admin.common.NoCurrency"></option>
                      </select>
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.ddlCurrency.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                  <div ng-if="userDetailCtrl.cefConfig.featureSet.languages.enabled"
                    class="form-group col-sm-6"
                    ng-class="{'has-error': userDetailCtrl.forms.Details.ddlLanguage.$invalid}">
                    <label class="control-label" data-translate="ui.admin.common.Language"></label>
                    <div class="input-group">
                      <select class="form-control" id="ddlLanguage" name="ddlLanguage"
                        ng-options="l.ID as (l.UnicodeName + (l.CustomKey  && l.CustomKey != '' ? ' [' + l.CustomKey + ']' : ''))
                                    for l in userDetailCtrl.languages
                                    | orderBy: ['SortOrder','DisplayName || Name']"
                        ng-model="userDetailCtrl.record.LanguageID">
                        <option value="" data-translate="ui.admin.common.NoLanguage"></option>
                      </select>
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.ddlLanguage.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                </div>
                <h3 data-translate="ui.admin.common.ContactInformation"></h3>
                <div class="row">
                  <text-input-form-group
                    class="col-sm-6"
                    key="FirstNameA"
                    ng-model="userDetailCtrl.record.Contact.FirstName"
                    label-key="ui.admin.common.FirstName"
                    placeholder-key="ui.admin.common.FirstName"
                    max-length="128"
                    ng-required="true">
                  </text-input-form-group>
                  <text-input-form-group
                    class="col-sm-6"
                    key="LastNameA"
                    ng-model="userDetailCtrl.record.Contact.LastName"
                    label-key="ui.admin.common.LastName"
                    placeholder-key="ui.admin.common.LastName"
                    max-length="128"
                    ng-required="true">
                  </text-input-form-group>
                </div>
                <div class="row">
                  <div class="form-group col-md-7" ng-class="{'has-error': userDetailCtrl.forms.Details.txtPhone.$invalid}">
                    <label class="control-label" data-translate="ui.admin.common.Phone"></label>
                    <div class="input-group">
                      <div class="input-group-addon"><i class="far fa-fw fa-phone" aria-hidden="true"></i></div>
                      <input type="text" class="form-control"
                        id="txtPhone" name="txtPhone"
                        placeholder="+1 (555) 555-5555 x55555"
                        maxlength="64"
                        ng-required="false"
                        ng-model="userDetailCtrl.record.Contact.Phone1" />
                      <!--ng-pattern="/^(\+?\d{1,2}(-|\s)?)?\(?\d{3}(\)\s?|-)?\d{3}-?\d{4}(\s?x\d{1,5})?$/"-->
                      <div class="input-group-addon"
                        ><label class="text-nowrap mb-0"
                        ><input type="checkbox" disabled ng-model="userDetailCtrl.record.PhoneConfirmed"
                        />&nbsp;<span data-translate="ui.admin.common.Confirmed"
                        ></span></label></div>
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.txtPhone.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                  <div class="form-group col-md-5" ng-class="{'has-error': userDetailCtrl.forms.Details.txtFaxA.$invalid}">
                    <label class="control-label" data-translate="ui.admin.common.Fax"></label>
                    <div class="input-group">
                      <div class="input-group-addon" aria-hidden="true"><i class="far fa-fw fa-fax"></i></div>
                      <input type="text" class="form-control"
                        id="txtFaxA" name="txtFaxA"
                        placeholder="+1 (555) 555-5555"
                        maxlength="64"
                        ng-required="false"
                        ng-model="userDetailCtrl.record.Contact.Fax1" />
                      <!--ng-pattern="/^(\+?\d{1,2}(-|\s)?)?\(?\d{3}\)?-?\d{3}-?\d{4}$/"-->
                      <!--ui-mask="'(999) 999-9999'"-->
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.txtFaxA.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                </div>
                <div class="form-group" ng-class="{'has-error': userDetailCtrl.forms.Details.txtEmailA.$invalid}">
                  <label class="control-label" data-translate="ui.admin.common.Email"></label>
                  <div class="input-group">
                    <div class="input-group-addon" aria-hidden="true"><i class="far fa-fw fa-at"></i></div>
                    <input type="email" class="form-control"
                      id="txtEmailA" name="txtEmailA"
                      ng-required="true" maxlength="512"
                      ng-change="userDetailCtrl.record.Contact.Email1 = userDetailCtrl.record.Email"
                      ng-model="userDetailCtrl.record.Email" />
                    <div class="input-group-addon"
                      ><label class="text-nowrap mb-0"
                      ><input type="checkbox" disabled ng-model="userDetailCtrl.record.EmailConfirmed"
                      />&nbsp;<span data-translate="ui.admin.common.Confirmed"
                      ></span></label></div>
                  </div>
                  <div ng-messages="userDetailCtrl.forms.Details.txtEmailA.$error">
                    <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                  </div>
                </div>
                <h3 data-translate="ui.admin.controls.accounts.userDetail.LoginInformation"></h3>
                <div class="row">
                  <div class="form-group col-sm-6"
                    ng-class="{'has-error': userDetailCtrl.forms.Details.txtUsername.$invalid}">
                    <label class="control-label" data-translate="ui.admin.controls.accounts.userDetail.UsernameCanBeAnEmail"></label>
                    <div class="input-group">
                      <input type="text" class="form-control"
                        id="txtUsername" name="txtUsername"
                        ng-required="true" maxlength="128"
                        ng-model="userDetailCtrl.record.UserName" />
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.txtUsername.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                  <div class="form-group col-sm-6" ng-class="{'has-error': userDetailCtrl.forms.Details.txtPassword.$invalid}">
                    <label class="control-label" data-translate="ui.admin.common.Password"></label>
                    <div class="input-group">
                      <input type="password" class="form-control"
                        id="txtPassword" name="txtPassword"
                        autocomplete="off"
                        ng-required="!userDetailCtrl.record.ID || userDetailCtrl.record.ID <= 0"
                        ng-model="userDetailCtrl.password" />
                    </div>
                    <div ng-messages="userDetailCtrl.forms.Details.txtPassword.$error">
                      <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                    </div>
                  </div>
                </div>
                <!-- TODO@JTG: Enable Two-Factor Authentication with Identity
                <div class="form-group" ng-class="{'has-error': userDetailCtrl.forms.Details.ckTwoFactor.$invalid}">
                  <label class="control-label">Two-Factor</label>
                  <div class="input-group">
                    <toggle id="ckTwoFactor" name="ckTwoFactor" class="btn-block"
                      ng-model="userDetailCtrl.record.TwoFactorEnabled"
                      data-on="Enabled" data-truestyle="btn-success"
                      data-off="Disabled" data-offstyle="btn-warning">
                    </toggle>
                  </div>
                  <div ng-messages="userDetailCtrl.forms.Details.ckTwoFactor.$error">
                    <div ng-messages-include="{{'/framework/admin/widgets/forms/_validationMessages.html' | corsLink: 'ui'}}"></div>
                  </div>
                </div>-->
                <div class="form-group">
                  <label class="control-label" data-translate="ui.admin.controls.accounts.userDetail.LockedOut"></label>
                  <div class="input-group">
                    <div class="input-group-addon"><input type="checkbox" ng-model="userDetailCtrl.record.LockoutEnabled" disabled /></div>
                    <input type="number" class="form-control text-right" ng-model="userDetailCtrl.record.AccessFailedCount" disabled />
                    <div class="input-group-btn">
                      <button type="button" class="btn btn-default btn-secondary"
                        ng-disabled="!userDetailCtrl.record.LockoutEnabled"
                        ng-click="userDetailCtrl.unlockUser()">
                        <i class="far fa-fw fa-unlock"></i>&nbsp;<span data-translate="ui.admin.controls.accounts.userDetail.Unlock"></span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6" ng-if="userDetailCtrl.record">
                <h3 data-translate="ui.admin.common.ContactAddress"></h3>
                <div cef-contact-editor-widget
                  class="mb-3"
                  contact="userDetailCtrl.record.Contact"
                  is-editable="true"
                  id-suffix="user"
                  hide-key="true"
                  hide-personal-details="true">
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Roles.$invalid}"
            ><i class="far fa-lg fa-th-list"></i>&nbsp;<span data-translate="ui.admin.common.Role.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.Roles">
            <div class="row"><div class="col-sm-12"><h3 data-translate="ui.admin.controls.accounts.userDetail.RolesAssignedToTheUser"></h3></div></div>
            <div class="row">
              <div class="col-sm-12">
                <p><b data-translate="ui.admin.common.Note"></b>&nbsp;<!--
                --><span data-translate="ui.admin.controls.accounts.userDetail.RolesCannotBeAddedDirectlyToANewUserTheUserMustBeSavedFirst"></span></p>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <p><b data-translate="ui.admin.common.Warning"></b>&nbsp;<!--
                --><span data-translate="ui.admin.controls.accounts.userDetail.RoleAssignmentsOccurDirectlyWithoutPressing"></span>&nbsp;<!--
                --><b data-translate="ui.admin.common.SaveChange.Plural"></b></p>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <!-- TODO: If they already have all the available roles assigned to them, don't allow Add -->
                <cv-account-user-role-modal
                  user-id="userDetailCtrl.record.ID"
                  dg-type="'Add'"
                  title-key="ui.admin.common.AddRole">
                  <i class="far fa-plus" aria-hidden="true"></i>&nbsp;<!--
                  --><span data-translate="ui.admin.common.AddRole"></span>
                </cv-account-user-role-modal>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <div class="table-responsive">
                  <table class="table table-condensed table-hover">
                    <thead>
                      <tr>
                        <th data-translate="ui.admin.common.Role"></th>
                        <th data-translate="ui.admin.common.Start"></th>
                        <th data-translate="ui.admin.common.End"></th>
                        <th style="width:86px;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-if="!userDetailCtrl.rolesForUser.length">
                        <td colspan="4" data-translate="ui.admin.controls.accounts.userDetail.NoRolesHaveBeenAssignedToThisUser"></td>
                      </tr>
                      <tr ng-repeat="ur in userDetailCtrl.rolesForUser">
                        <td><label class="form-control-static" ng-bind="ur.Name"></label></td>
                        <td><label class="form-control-static" ng-bind="(ur.StartDate | convertJSONDate | date: 'yyyy MMM dd hh:mm a') || '-'"></label></td>
                        <td><label class="form-control-static" ng-bind="(ur.EndDate | convertJSONDate | date:'yyyy MMM dd hh:mm a') || '-'"></label></td>
                        <td class="text-nowrap">
                          <!--
                          <cv-account-user-role-modal
                            user-id="ur.UserId"
                            role-id="ur.RoleId"
                            dg-type="'Update'"
                            title-key="ui.admin.common.EditRole">
                            <i class="far fa-pencil" aria-hidden="true"></i><! --
                            -- ><span class="sr-only" data-translate="ui.admin.common.EditRole"></span>
                          </cv-account-user-role-modal>
                          -->
                          <cv-account-user-role-modal
                            user-id="ur.UserId"
                            role-id="ur.RoleId"
                            dg-type="'Remove'"
                            title-key="ui.admin.common.RemoveRole">
                            <i class="far fa-times" aria-hidden="true"></i><!--
                            --><span class="sr-only" data-translate="ui.admin.common.RemoveRole"></span>
                          </cv-account-user-role-modal>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.cefConfig.featureSet.stores.enabled && userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Stores.$invalid}"
            ><i class="far fa-lg fa-building"></i>&nbsp;<span data-translate="ui.admin.common.Store.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.Stores">
            <div class="row">
              <div class="col-sm-12">
                <h3 class="mb-3"
                  data-translate="ui.admin.controls.accounts.userDetail.StoresAssociatedWithThisUser">
                </h3>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-8">
                <h4 data-translate="ui.admin.controls.accounts.discountDetail.SelectStoresToAdd"></h4>
                <div cef-paging-header paging="userDetailCtrl.storePaging"></div>
                <div class="table-responsive">
                  <table class="table table-striped table-hover table-condensed mb-3">
                    <thead>
                      <tr>
                        <th class="w-5" data-translate="ui.admin.common.Number.Symbol"></th>
                        <th class="w-35" data-translate="ui.admin.common.Key"></th>
                        <th class="w-60" data-translate="ui.admin.common.Name"></th>
                        <th style="width:43px;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-show="userDetailCtrl.storePaging.filteredCount === 0">
                        <td colspan="6" data-translate="ui.admin.controls.sales.modals.editALineItemModal.NoResultsFound"></td>
                      </tr>
                      <tr ng-repeat="p in userDetailCtrl.storePaging.filteredData[userDetailCtrl.storePaging.currentPage]
                                     | orderBy: ['SortOrder','Group','DisplayName || Name','CustomKey']
                                     | limitTo: userDetailCtrl.storePaging.pageSize
                                              : userDetailCtrl.storePaging.skip()">
                        <td><label class="font-weight-normal form-control-static" ng-bind="p.ID"></label></td>
                        <td><label class="font-weight-normal form-control-static" ng-bind="p.CustomKey"></label></td>
                        <td><label class="font-weight-normal form-control-static" ng-bind="p.Name"></label></td>
                        <td>
                          <button type="button" class="btn btn-success"
                            translate-attr="{ title: 'ui.admin.common.Add',
                                              'aria-label': 'ui.admin.common.Add' }"
                            ng-click="userDetailCtrl.addStore(p.ID)">
                            <i class="far fa-plus"></i>
                            <span class="sr-only" data-translate="ui.admin.common.Add"></span>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="col-sm-4">
                <h4 data-translate="ui.admin.controls.accounts.discountDetail.AddedStores"></h4>
                <input type="text" class="form-control"
                  translate-attr="{ placeholder: 'ui.admin.common.QuickFilter' }"
                  ng-model="userDetailCtrl.addedStoresQuickFilter" />
                <table class="table table-striped table-hover table-condensed mb-0">
                  <thead>
                    <tr>
                      <th data-translate="ui.admin.common.Store"></th>
                      <th style="width:43px;"></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr ng-if="(userDetailCtrl.record.Stores | filter: { $: userDetailCtrl.addedStoresQuickFilter }).length <= 0">
                      <td colspan="2" data-translate="ui.admin.controls.sales.modals.editALineItemModal.NoResultsFound"></td>
                    </tr>
                    <tr ng-repeat="p in userDetailCtrl.record.Stores
                                   | filter: { $: userDetailCtrl.addedStoresQuickFilter }
                                   | orderBy: ['StoreName','Store.Name']">
                      <td>
                        <label class="font-weight-normal form-control-static"
                          uib-tooltip="{{p.MasterID + ' ' + (p.MasterKey || p.Master.CustomKey) + ' ' + (p.MasterName || p.Master.Name)}}"
                          ng-bind="p.MasterName || p.Master.Name">
                        </label>
                      </td>
                      <td>
                        <button type="button" class="btn btn-danger"
                          translate-attr="{ title: 'ui.admin.controls.accounts.discountDetail.Deselect',
                                            'aria-label': 'ui.admin.controls.accounts.discountDetail.Deselect' }"
                          ng-click="userDetailCtrl.removeStore($index)">
                          <i class="far fa-times"></i>
                          <span class="sr-only"
                            data-translate="ui.admin.controls.accounts.discountDetail.Deselect">
                          </span>
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.cefConfig.featureSet.brands.enabled && userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Brands.$invalid}"><i class="far fa-lg fa-building"></i>&nbsp;<!--
          --><span data-translate="ui.admin.common.Brand.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.Brands">
            <div class="row">
              <div class="col-sm-12 mb-3">
                <h3 data-translate="ui.admin.common.Brand.PluralAssociatedWithThisAccount"></h3>
                <button type="button" class="btn btn-primary"
                  data-translate="ui.admin.controls.accounts.accountDetail.AddBrand"
                  ng-click="userDetailCtrl.addBrand()">
                </button>
                <b data-translate="ui.admin.common.Note"></b>&nbsp;<!--
                --><span data-translate="ui.admin.common.TheseCanBeManagedFromTheBrandEditorAsWell"></span>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <div class="table-responsive">
                  <table class="table table-condensed table-hover">
                    <thead>
                      <tr>
                        <th style="width:50px;">#</th>
                        <th style="width:125px;" data-translate="ui.admin.controls.accounts.accountDetail.AccessToBrand"></th>
                        <th data-translate="ui.admin.controls.accounts.accountDetail.Brand"></th>
                        <th style="width:43px;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-if="!userDetailCtrl.record.Brands.length">
                        <td colspan="4" data-translate="ui.admin.common.NoBrandsHaveBeenAdded"></td>
                      </tr>
                      <tr ng-repeat="brandUser in userDetailCtrl.record.Brands">
                        <td>
                          <label class="form-control-static" ng-bind="brandUser.ID"></label>
                        </td>
                        <td>
                          <toggle id="ckHasAccessToBrand{{$index}}" name="ckHasAccessToBrand{{$index}}" class="btn-block"
                            ng-model="brandUser.HasAccessToBrand"
                            data-on="Access" data-truestyle="btn-success"
                            data-off="Restricted" data-offstyle="btn-danger">
                          </toggle>
                        </td>
                        <td>
                          <select class="form-control"
                            id="ddlAccountBrand{{$index}}" name="ddlAccountBrand{{$index}}"
                            ng-required="true"
                            ng-options="s.ID as ((s.DisplayName || s.Name) + (s.CustomKey && s.CustomKey != '' ? ' [' + s.CustomKey + ']' : ''))
                                        for s in userDetailCtrl.brands
                                        | orderBy: ['SortOrder','DisplayName || Name']"
                            ng-model="brandUser.MasterID">
                            <option value="" ng-disabled="true" data-translate="ui.admin.common.SelectABrand"></option>
                          </select>
                        </td>
                        <td>
                          <button type="button" class="btn btn-danger"
                            translate-attr="{ title: 'ui.admin.controls.accounts.accountDetail.Delete',
                                              'aria-label': 'ui.admin.controls.accounts.accountDetail.Delete' }"
                            ng-click="userDetailCtrl.removeBrand($index)">
                            <i class="far fa-times"></i>
                            <span class="sr-only"
                              data-translate="ui.admin.controls.accounts.accountDetail.Delete">
                            </span>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Images.$invalid}"><i class="far fa-lg fa-picture-o"></i>&nbsp;<!--
          --><span data-translate="ui.admin.common.Image.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.Images">
            <div class="row">
              <div class="col-sm-12">
                <h3 data-translate="ui.admin.common.Image.Plural"></h3>
                <!-- Uploader -->
                <div cef-upload-image-widget
                  master="userDetailCtrl.record"
                  upload-type="ImageUser"
                  type-key="General"
                  allow-multiple="true"
                  is-primary="false">
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <!-- Thumbnails -->
                <div class="form-group">
                  <label class="control-label"
                    data-translate="ui.admin.common.UploadedImage.Plural">
                  </label>
                  <div class="input-group">
                    <div ng-if="!userDetailCtrl.record.Images.length"
                      data-translate="ui.admin.common.NoImagesHaveBeenUploaded">
                    </div>
                    <div ng-repeat="image in userDetailCtrl.record.Images" class="thumbnail col-sm-4 col-md-3 col-lg-2">
                      <div class="form-vertical">
                        <div class="form-group">
                          <img alt="{{image.Name}}" class="col-sm-12 img-rounded"
                            ng-src="{{(image.ThumbnailFileName || image.OriginalFileName)
                                       | corsImageLink : 'users' : { 'maxwidth': 250, 'maxheight': 250, 'mode': 'pad', 'scale': 'both' } }}"
                            onerror="this.onerror=null;this.src='/DesktopModules/ClarityEcommerce/UI-Admin/framework/store/img/placeholder.jpg?maxwidth=250&amp;maxheight=250&amp;mode=pad&amp;scale=both';" />
                        </div>
                        <text-input-form-group
                          key="ImageName{{$index}}"
                          ng-model="image.Name"
                          label-key="ui.admin.common.Name"
                          max-length="128"
                          ng-required="true">
                        </text-input-form-group>
                        <select-form-group
                          key="ImageTypeID{{$index}}"
                          ng-model="image.TypeID"
                          selections="userDetailCtrl.imageTypes"
                          label-key="ui.admin.common.Type"
                          tooltip-text="The type of the record."
                          placeholder-key="ui.admin.common.Type"
                          ng-required="true">
                        </select-form-group>
                        <toggle-form-group
                          key="ImageIsPrimary{{$index}}"
                          ng-change="userDetailCtrl.clearOtherPrimaryImagesNew($index)"
                          ng-model="image.IsPrimary"
                          label-key="ui.admin.controls.inventory.productDetail.PrimaryImageShownFirst"
                          tog-on-key="ui.admin.common.Primary" tog-on-style="btn-success"
                          tog-off-key="ui.admin.common.Other" tog-off-style="btn-info"
                          ng-required="false">
                        </toggle-form-group>
                        <button type="button" class="btn btn-danger btn-block"
                          translate-attr="{ title: 'ui.admin.common.Delete',
                                            'aria-label': 'ui.admin.common.Delete' }"
                          ng-click="userDetailCtrl.removeImageNew($index)">
                          <i class="far fa-trash-o"></i>&nbsp;<!--
                          --><span data-translate="ui.admin.common.Delete"></span>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.cefConfig.featureSet.users.storedFiles.enabled && userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.StoredFiles.$invalid}"><i class="far fa-lg fa-file"></i>&nbsp;<!--
          --><span data-translate="ui.admin.common.StoredFile.Plural"></span></span></uib-tab-heading>
          <div class="form-vertical container-fluid" ng-form="userDetailCtrl.forms.StoredFiles">
            <div class="row">
              <div class="col-md-12"><h3 data-translate="ui.admin.common.StoredFile.Plural"></h3></div>
              <div class="col-md-12 mb-3">
                <!-- Uploader -->
                <div cef-upload-file-widget
                  master="userDetailCtrl.record"
                  upload-type="StoredFileUser"
                  type-key="General"
                  allow-multiple="true"
                  form="userDetailCtrl.forms.StoredFiles">
                </div>
              </div>
              <div class="col-md-12">
                <div class="table-responsive">
                  <table class="table table-hover table-condensed table-striped">
                    <thead>
                      <tr>
                        <th data-translate="ui.admin.common.Name"></th>
                        <th data-translate="ui.admin.common.FileName"></th>
                        <th style="width: 43px;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr ng-if="!userDetailCtrl.record.StoredFiles.length">
                        <td colspan="3"
                          data-translate="ui.admin.common.NoStoredFilesHaveBeenAdded">
                        </td>
                      </tr>
                      <tr ng-repeat="storedFile in userDetailCtrl.record.StoredFiles">
                        <td>
                          <input type="text" class="form-control"
                            id="txtStoredFileName{{$index}}" name="txtStoredFileName{{$index}}"
                            ng-required="true"
                            max-length="128"
                            ng-model="storedFile.Name" />
                        </td>
                        <td>
                          <a class="form-control-static" target="_blank"
                            ng-href="{{(storedFile.StoredFileName || storedFile.SlaveName) | corsStoredFilesLink: 'users'}}"
                            ng-bind="storedFile.SlaveName">
                          </a>
                        </td>
                        <td>
                          <button type="button" class="btn btn-danger"
                            translate-attr="{ title: 'ui.admin.common.Delete',
                                              'aria-label': 'ui.admin.common.Delete' }"
                            ng-click="userDetailCtrl.removeFileNew($index)">
                            <i class="far fa-trash"></i><!--
                            --><span class="sr-only" data-translate="ui.admin.common.Delete"></span>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </uib-tab>
        <uib-tab ng-if="userDetailCtrl.record.ID > 0">
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Notes.$invalid}"
            ><i class="far fa-lg fa-sticky-note-o"></i>&nbsp;<span data-translate="ui.admin.common.Note.Plural"></span></span></uib-tab-heading>
          <div class="container-fluid" ng-form="userDetailCtrl.forms.Notes">
            <div class="row"><div class="col-sm-12"><h3 data-translate="ui.admin.common.PrivateNote.Plural"></h3></div></div>
            <cef-notes-editor
              ng-if="userDetailCtrl.record"
              notes="userDetailCtrl.record.Notes"
              note-type-name="'Private'">
            </cef-notes-editor>
          </div>
        </uib-tab>
        <uib-tab>
          <uib-tab-heading><span ng-class="{'text-danger': userDetailCtrl.forms.Attributes.$invalid}"><i class="far fa-lg fa-list"></i>&nbsp;<!--
          --><span data-translate="ui.admin.common.Attribute.Plural"></span></span></uib-tab-heading>
          <div class="container-fluid" ng-form="userDetailCtrl.forms.Attributes">
            <div cef-json-attributes-editor
              master="userDetailCtrl.record"
              type="User"
              ng-if="userDetailCtrl.record != null">
            </div>
          </div>
        </uib-tab>
      </uib-tabset>
    </div>
  </div>
  <!-- Form actions -->
  <div class="row details-footer">
    <div class="col-md-12">
      <cef-standard-detail-footer-buttons
        master-controller="userDetailCtrl"
        return-state="accounts.users.list"
        permissions-base="Contacts.User">
      </cef-standard-detail-footer-buttons>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-warning pull-right"
        ng-hide="userDetailCtrl.record.RequirePasswordChangeOnNextLogin"
        ng-click="userDetailCtrl.doRequirePasswordChangeOnNextLoginDorUser()">
        <i class="far fa-fw fa-thumbs-up"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.DoRequirePasswordChangeOnNextLogin"></span>
      </button>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-danger pull-right"
        ng-show="userDetailCtrl.record.RequirePasswordChangeOnNextLogin"
        ng-click="userDetailCtrl.dontRequirePasswordChangeOnNextLoginForUser()">
        <i class="far fa-fw fa-thumbs-down"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.DontRequirePasswordChangeOnNextLogin"></span>
      </button>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-warning pull-right"
        ng-hide="userDetailCtrl.record.IsApproved"
        ng-click="userDetailCtrl.approveUser()">
        <i class="far fa-fw fa-thumbs-up"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.ApproveUser"></span>
      </button>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-danger pull-right"
        ng-show="userDetailCtrl.record.IsApproved"
        ng-click="userDetailCtrl.unApproveUser()">
        <i class="far fa-fw fa-thumbs-down"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.UnapproveUser"></span>
      </button>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-danger pull-right"
        ng-hide="userDetailCtrl.record.LockoutEnabled"
        ng-click="userDetailCtrl.lockUser()">
        <i class="far fa-fw fa-lock"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.LockUser"></span>
      </button>
      <button ng-if="userDetailCtrl.record.ID > 0"
        type="button" class="btn btn-warning pull-right"
        ng-show="userDetailCtrl.record.LockoutEnabled"
        ng-click="userDetailCtrl.unlockUser()">
        <i class="far fa-fw fa-unlock"></i>&nbsp;<!--
        --><span data-translate="ui.admin.controls.accounts.userDetail.UnlockUser"></span>
      </button>
    </div>
  </div>
</div>
