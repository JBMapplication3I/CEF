(function(n){ColVis=function(n,t){return this.CLASS&&this.CLASS=="ColVis"||alert("Warning: ColVis must be initialised with the keyword 'new'"),typeof t=="undefined"&&(t={}),this.s={dt:null,oInit:t,fnStateChange:null,activate:"click",sAlign:"left",buttonText:"Show / hide columns",hidden:!0,aiExclude:[],abOriginal:[],bShowAll:!1,sShowAll:"Show All",bRestore:!1,sRestore:"Restore original",iOverlayFade:500,fnLabel:null,sSize:"auto",bCssPosition:!1},this.dom={wrapper:null,button:null,collection:null,background:null,catcher:null,buttons:[],restore:null},ColVis.aInstances.push(this),this.s.dt=n,this._fnConstruct(),this};ColVis.prototype={fnRebuild:function(){for(var n=this.dom.buttons.length-1;n>=0;n--)this.dom.buttons[n]!==null&&this.dom.collection.removeChild(this.dom.buttons[n]);this.dom.buttons.splice(0,this.dom.buttons.length);this.dom.restore&&this.dom.restore.parentNode(this.dom.restore);this._fnAddButtons();this._fnDrawCallback()},_fnConstruct:function(){this._fnApplyCustomisation();var i=this,t,r;for(this.dom.wrapper=document.createElement("div"),this.dom.wrapper.className="ColVis TableTools",this.dom.button=this._fnDomBaseButton(this.s.buttonText),this.dom.button.className+=" ColVis_MasterButton",this.dom.wrapper.appendChild(this.dom.button),this.dom.catcher=this._fnDomCatcher(),this.dom.collection=this._fnDomCollection(),this.dom.background=this._fnDomBackground(),this._fnAddButtons(),t=0,r=this.s.dt.aoColumns.length;t<r;t++)this.s.abOriginal.push(this.s.dt.aoColumns[t].bVisible);this.s.dt.aoDrawCallback.push({fn:function(){i._fnDrawCallback.call(i)},sName:"ColVis"});n(this.s.dt.oInstance).bind("column-reorder",function(n,u,f){for(t=0,r=i.s.aiExclude.length;t<r;t++)i.s.aiExclude[t]=f.aiInvertMapping[i.s.aiExclude[t]];var e=i.s.abOriginal.splice(f.iFrom,1)[0];i.s.abOriginal.splice(f.iTo,0,e);i.fnRebuild()})},_fnApplyCustomisation:function(){var n=this.s.oInit;typeof n.activate!="undefined"&&(this.s.activate=n.activate);typeof n.buttonText!="undefined"&&(this.s.buttonText=n.buttonText);typeof n.aiExclude!="undefined"&&(this.s.aiExclude=n.aiExclude);typeof n.bRestore!="undefined"&&(this.s.bRestore=n.bRestore);typeof n.sRestore!="undefined"&&(this.s.sRestore=n.sRestore);typeof n.bShowAll!="undefined"&&(this.s.bShowAll=n.bShowAll);typeof n.sShowAll!="undefined"&&(this.s.sShowAll=n.sShowAll);typeof n.sAlign!="undefined"&&(this.s.sAlign=n.sAlign);typeof n.fnStateChange!="undefined"&&(this.s.fnStateChange=n.fnStateChange);typeof n.iOverlayFade!="undefined"&&(this.s.iOverlayFade=n.iOverlayFade);typeof n.fnLabel!="undefined"&&(this.s.fnLabel=n.fnLabel);typeof n.sSize!="undefined"&&(this.s.sSize=n.sSize);typeof n.bCssPosition!="undefined"&&(this.s.bCssPosition=n.bCssPosition)},_fnDrawCallback:function(){for(var i=this.s.dt.aoColumns,t=0,r=i.length;t<r;t++)this.dom.buttons[t]!==null&&(i[t].bVisible?n("input",this.dom.buttons[t]).attr("checked","checked"):n("input",this.dom.buttons[t]).removeAttr("checked"))},_fnAddButtons:function(){for(var n,i=","+this.s.aiExclude.join(",")+",",t=0,r=this.s.dt.aoColumns.length;t<r;t++)i.indexOf(","+t+",")==-1?(n=this._fnDomColumnButton(t),this.dom.buttons.push(n),this.dom.collection.appendChild(n)):this.dom.buttons.push(null);this.s.bRestore&&(n=this._fnDomRestoreButton(),n.className+=" ColVis_Restore",this.dom.buttons.push(n),this.dom.collection.appendChild(n));this.s.bShowAll&&(n=this._fnDomShowAllButton(),n.className+=" ColVis_ShowAll",this.dom.buttons.push(n),this.dom.collection.appendChild(n))},_fnDomRestoreButton:function(){var t=this,i=document.createElement("button"),r=document.createElement("span");return i.className=this.s.dt.bJUI?"ColVis_Button TableTools_Button ui-button ui-state-default":"ColVis_Button TableTools_Button",i.appendChild(r),n(r).html('<span class="ColVis_title">'+this.s.sRestore+"<\/span>"),n(i).click(function(){for(var n=0,i=t.s.abOriginal.length;n<i;n++)t.s.dt.oInstance.fnSetColumnVis(n,t.s.abOriginal[n],!1);t._fnAdjustOpenRows();t.s.dt.oInstance.fnAdjustColumnSizing(!1);t.s.dt.oInstance.fnDraw(!1)}),i},_fnDomShowAllButton:function(){var t=this,i=document.createElement("button"),r=document.createElement("span");return i.className=this.s.dt.bJUI?"ColVis_Button TableTools_Button ui-button ui-state-default":"ColVis_Button TableTools_Button",i.appendChild(r),n(r).html('<span class="ColVis_title">'+this.s.sShowAll+"<\/span>"),n(i).click(function(){for(var n=0,i=t.s.abOriginal.length;n<i;n++)t.s.aiExclude.indexOf(n)===-1&&t.s.dt.oInstance.fnSetColumnVis(n,!0,!1);t._fnAdjustOpenRows();t.s.dt.oInstance.fnAdjustColumnSizing(!1);t.s.dt.oInstance.fnDraw(!1)}),i},_fnDomColumnButton:function(t){var i=this,f=this.s.dt.aoColumns[t],r=document.createElement("button"),e=document.createElement("span"),u=this.s.dt,o;return r.className=u.bJUI?"ColVis_Button TableTools_Button ui-button ui-state-default":"ColVis_Button TableTools_Button",r.appendChild(e),o=this.s.fnLabel===null?f.sTitle:this.s.fnLabel(t,f.sTitle,f.nTh),n(e).html('<span class="ColVis_radio"><input type="checkbox"/><\/span><span class="ColVis_title">'+o+"<\/span>"),n(r).click(function(r){var f=!n("input",this).is(":checked"),e;r.target.nodeName.toLowerCase()=="input"&&(f=n("input",this).is(":checked"));e=n.fn.dataTableExt.iApiIndex;n.fn.dataTableExt.iApiIndex=i._fnDataTablesApiIndex.call(i);u.oFeatures.bServerSide&&(u.oScroll.sX!==""||u.oScroll.sY!=="")?(i.s.dt.oInstance.fnSetColumnVis(t,f,!1),i.s.dt.oInstance.fnAdjustColumnSizing(!1),i.s.dt.oInstance.oApi._fnScrollDraw(i.s.dt),i._fnDrawCallback()):i.s.dt.oInstance.fnSetColumnVis(t,f);n.fn.dataTableExt.iApiIndex=e;i.s.fnStateChange!==null&&i.s.fnStateChange.call(i,t,f)}),r},_fnDataTablesApiIndex:function(){for(var n=0,t=this.s.dt.oInstance.length;n<t;n++)if(this.s.dt.oInstance[n]==this.s.dt.nTable)return n;return 0},_fnDomBaseButton:function(t){var u=this,i=document.createElement("button"),r=document.createElement("span"),f=this.s.activate=="mouseover"?"mouseover":"click";return i.className=this.s.dt.bJUI?"ColVis_Button TableTools_Button ui-button ui-state-default":"ColVis_Button TableTools_Button",i.appendChild(r),r.innerHTML=t,n(i).bind(f,function(n){u._fnCollectionShow();n.preventDefault()}),i},_fnDomCollection:function(){var i=this,t=document.createElement("div");return t.style.display="none",t.className=this.s.dt.bJUI?"ColVis_collection TableTools_collection ui-buttonset ui-buttonset-multi":"ColVis_collection TableTools_collection",this.s.bCssPosition||(t.style.position="absolute"),n(t).css("opacity",0),t},_fnDomCatcher:function(){var i=this,t=document.createElement("div");return t.className="ColVis_catcher TableTools_catcher",n(t).click(function(){i._fnCollectionHide.call(i,null,null)}),t},_fnDomBackground:function(){var i=this,t=document.createElement("div");return t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.className="ColVis_collectionBackground TableTools_collectionBackground",n(t).css("opacity",0),n(t).click(function(){i._fnCollectionHide.call(i,null,null)}),this.s.activate=="mouseover"&&n(t).mouseover(function(){i.s.overcollection=!1;i._fnCollectionHide.call(i,null,null)}),t},_fnCollectionShow:function(){var s=this,t,f,h=n(this.dom.button).offset(),i=this.dom.collection,e=this.dom.background,r=parseInt(h.left,10),p=parseInt(h.top+n(this.dom.button).outerHeight(),10),u,c,l,w;this.s.bCssPosition||(i.style.top=p+"px",i.style.left=r+"px");i.style.display="block";n(i).css("opacity",0);var a=n(window).height(),v=n(document).height(),y=n(window).width(),o=n(document).width();if(e.style.height=(a>v?a:v)+"px",e.style.width=(y<o?y:o)+"px",u=this.dom.catcher.style,u.height=n(this.dom.button).outerHeight()+"px",u.width=n(this.dom.button).outerWidth()+"px",u.top=h.top+"px",u.left=r+"px",document.body.appendChild(e),document.body.appendChild(i),document.body.appendChild(this.dom.catcher),this.s.sSize=="auto"){for(c=[],this.dom.collection.style.width="auto",t=0,f=this.dom.buttons.length;t<f;t++)this.dom.buttons[t]!==null&&(this.dom.buttons[t].style.width="auto",c.push(n(this.dom.buttons[t]).outerWidth()));for(iMax=Math.max.apply(window,c),t=0,f=this.dom.buttons.length;t<f;t++)this.dom.buttons[t]!==null&&(this.dom.buttons[t].style.width=iMax+"px");this.dom.collection.style.width=iMax+"px"}this.s.bCssPosition||(i.style.left=this.s.sAlign=="left"?r+"px":r-n(i).outerWidth()+n(this.dom.button).outerWidth()+"px",l=n(i).outerWidth(),w=n(i).outerHeight(),r+l>o&&(i.style.left=o-l+"px"));setTimeout(function(){n(i).animate({opacity:1},s.s.iOverlayFade);n(e).animate({opacity:.1},s.s.iOverlayFade,"linear",function(){jQuery.browser.msie&&jQuery.browser.version=="6.0"&&s._fnDrawCallback()})},10);this.s.hidden=!1},_fnCollectionHide:function(){var t=this;this.s.hidden||this.dom.collection===null||(this.s.hidden=!0,n(this.dom.collection).animate({opacity:0},t.s.iOverlayFade,function(){this.style.display="none"}),n(this.dom.background).animate({opacity:0},t.s.iOverlayFade,function(){document.body.removeChild(t.dom.background);document.body.removeChild(t.dom.catcher)}))},_fnAdjustOpenRows:function(){for(var t=this.s.dt.aoOpenRows,i=this.s.dt.oApi._fnVisbleColumns(this.s.dt),n=0,r=t.length;n<r;n++)t[n].nTr.getElementsByTagName("td")[0].colSpan=i}};ColVis.fnRebuild=function(n){var i=null,t,r;for(typeof n!="undefined"&&(i=n.fnSettings().nTable),t=0,r=ColVis.aInstances.length;t<r;t++)(typeof n=="undefined"||i==ColVis.aInstances[t].s.dt.nTable)&&ColVis.aInstances[t].fnRebuild()};ColVis.aInstances=[];ColVis.prototype.CLASS="ColVis";ColVis.VERSION="1.0.8";ColVis.prototype.VERSION=ColVis.VERSION;typeof n.fn.dataTable=="function"&&typeof n.fn.dataTableExt.fnVersionCheck=="function"&&n.fn.dataTableExt.fnVersionCheck("1.7.0")?n.fn.dataTableExt.aoFeatures.push({fnInit:function(n){var t=typeof n.oInit.oColVis=="undefined"?{}:n.oInit.oColVis,i=new ColVis(n,t);return i.dom.wrapper},cFeature:"C",sFeature:"ColVis"}):alert("Warning: ColVis requires DataTables 1.7 or greater - www.datatables.net/download")})(jQuery);
/*
//# sourceMappingURL=ColVis.min.js.map
*/